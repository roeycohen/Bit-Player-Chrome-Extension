"use strict";angular.module("com.2fdevs.videogular",["ngSanitize"]).run(["$templateCache",function(a){a.put("vg-templates/vg-media-video","<video></video>"),a.put("vg-templates/vg-media-audio","<audio></audio>")}]),angular.module("com.2fdevs.videogular").constant("VG_STATES",{PLAY:"play",PAUSE:"pause",STOP:"stop"}),angular.module("com.2fdevs.videogular").controller("vgController",["$scope","$window","vgConfigLoader","vgFullscreen","VG_UTILS","VG_STATES",function(a,b,c,d,e,f){var g=null,h=!1,i=!1;this.videogularElement=null,this.clearMedia=function(){a.API.mediaElement[0].src=""},this.onCanPlay=function(){a.API.isBuffering=!1,a.$apply()},this.onVideoReady=function(){a.API.isReady=!0,a.API.autoPlay=a.vgAutoPlay,a.API.playsInline=a.vgPlaysInline,a.API.currentState=f.STOP,i=!0,a.vgConfig?c.loadConfig(a.vgConfig).then(this.onLoadConfig.bind(this)):a.vgPlayerReady({$API:a.API})},this.onLoadConfig=function(b){a.API.config=b,a.vgTheme=a.API.config.theme,a.vgAutoPlay=a.API.config.autoPlay,a.vgPlaysInline=a.API.config.playsInline,a.vgPlayerReady({$API:a.API})},this.onLoadMetaData=function(b){a.API.isBuffering=!1,a.API.onUpdateTime(b)},this.onUpdateTime=function(b){a.API.currentTime=1e3*b.target.currentTime,1/0!=b.target.duration?(a.API.totalTime=1e3*b.target.duration,a.API.timeLeft=1e3*(b.target.duration-b.target.currentTime),a.API.isLive=!1):a.API.isLive=!0,a.vgUpdateTime({$currentTime:b.target.currentTime,$duration:b.target.duration}),a.$apply()},this.onPlay=function(){a.API.setState(f.PLAY),a.$apply()},this.onPause=function(){a.API.setState(f.PAUSE),a.$apply()},this.onVolumeChange=function(){a.API.volume=a.API.mediaElement[0].volume,a.$apply()},this.seekTime=function(b,c){var d;c?(d=b*a.API.mediaElement[0].duration/100,a.API.mediaElement[0].currentTime=d):(d=b,a.API.mediaElement[0].currentTime=d),a.API.currentTime=1e3*d},this.playPause=function(){a.API.mediaElement[0].paused?this.play():this.pause()},this.setState=function(b){return b&&b!=a.API.currentState&&(a.vgUpdateState({$state:b}),a.API.currentState=b),a.API.currentState},this.play=function(){a.API.mediaElement[0].play(),this.setState(f.PLAY)},this.pause=function(){a.API.mediaElement[0].pause(),this.setState(f.PAUSE)},this.stop=function(){a.API.mediaElement[0].pause(),a.API.mediaElement[0].currentTime=0,this.setState(f.STOP)},this.toggleFullScreen=function(){!d.isAvailable||a.vgPlaysInline?(a.API.isFullScreen?(a.API.videogularElement.removeClass("fullscreen"),a.API.videogularElement.css("z-index","auto")):(a.API.videogularElement.addClass("fullscreen"),a.API.videogularElement.css("z-index",e.getZIndex())),a.API.isFullScreen=!a.API.isFullScreen):a.API.isFullScreen?e.isMobileDevice()||d.exit():e.isMobileDevice()?e.isiOSDevice()?i?this.enterElementInFullScreen(a.API.mediaElement[0]):(h=!0,this.play()):this.enterElementInFullScreen(a.API.mediaElement[0]):this.enterElementInFullScreen(a.API.videogularElement[0])},this.enterElementInFullScreen=function(a){d.request(a)},this.changeSource=function(b){a.vgChangeSource({$source:b})},this.setVolume=function(b){a.vgUpdateVolume({$volume:b}),a.API.mediaElement[0].volume=b,a.API.volume=b},this.updateTheme=function(a){var b,c,d=document.getElementsByTagName("link");if(g)for(b=0,c=d.length;c>b;b++)d[b].outerHTML.indexOf(g)>=0&&d[b].parentNode.removeChild(d[b]);if(a){var e=angular.element(document).find("head"),f=!1;for(b=0,c=d.length;c>b&&!(f=d[b].outerHTML.indexOf(a)>=0);b++);f||e.append("<link rel='stylesheet' href='"+a+"'>"),g=a}},this.onStartBuffering=function(){a.API.isBuffering=!0,a.$apply()},this.onStartPlaying=function(){a.API.isBuffering=!1,a.$apply()},this.onComplete=function(){a.vgComplete(),a.API.setState(f.STOP),a.API.isCompleted=!0,a.$apply()},this.onVideoError=function(b){a.vgError({$event:b})},this.addListeners=function(){a.API.mediaElement[0].addEventListener("canplay",a.API.onCanPlay,!1),a.API.mediaElement[0].addEventListener("loadedmetadata",a.API.onLoadMetaData,!1),a.API.mediaElement[0].addEventListener("waiting",a.API.onStartBuffering,!1),a.API.mediaElement[0].addEventListener("ended",a.API.onComplete,!1),a.API.mediaElement[0].addEventListener("playing",a.API.onStartPlaying,!1),a.API.mediaElement[0].addEventListener("play",a.API.onPlay,!1),a.API.mediaElement[0].addEventListener("pause",a.API.onPause,!1),a.API.mediaElement[0].addEventListener("volumechange",a.API.onVolumeChange,!1),a.API.mediaElement[0].addEventListener("timeupdate",a.API.onUpdateTime,!1),a.API.mediaElement[0].addEventListener("error",a.API.onVideoError,!1)},a.API=this,a.init=function(){a.API.isReady=!1,a.API.isCompleted=!1,a.API.currentTime=0,a.API.totalTime=0,a.API.timeLeft=0,a.API.isLive=!1,a.API.isConfig=void 0!=a.vgConfig,a.API.updateTheme(a.vgTheme),a.addBindings(),d.isAvailable&&document.addEventListener(d.onchange,a.onFullScreenChange)},a.addBindings=function(){a.$watch("vgTheme",function(b,c){b!=c&&a.API.updateTheme(b)}),a.$watch("vgAutoPlay",function(b,c){b!=c&&b&&a.API.play()}),a.$watch("vgPlaysInline",function(){a.API.playsInline=a.vgPlaysInline})},a.onFullScreenChange=function(){a.API.isFullScreen=d.isFullScreen(),a.$apply()},a.$on("$destroy",this.clearMedia),a.$on("$routeChangeStart",this.clearMedia),a.init()}]),angular.module("com.2fdevs.videogular").directive("vgLoop",[function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){var e;a.setLoop=function(a){a?d.mediaElement.attr("loop",a):d.mediaElement.removeAttr("loop")},d.isConfig?a.$watch(function(){return d.config},function(){d.config&&a.setLoop(d.config.loop)}):a.$watch(c.vgLoop,function(b,c){e&&b==c||!b?a.setLoop():(e=b,a.setLoop(e))})}}}}]),angular.module("com.2fdevs.videogular").directive("vgMedia",["$timeout","VG_STATES",function(a,b){return{restrict:"E",require:"^videogular",templateUrl:function(a,b){var c=b.vgType||"video";return b.vgTemplate||"vg-templates/vg-media-"+c},scope:{vgSrc:"=?",vgType:"=?"},link:function(c,d,e,f){var g;e.vgType=e.vgType&&"video"!==e.vgType?"audio":"video",c.onChangeSource=function(a,b){g&&a==b||!a||(g=a,f.sources=g,c.changeSource())},c.changeSource=function(){var c="";if(f.mediaElement[0].canPlayType){for(var d=0,e=g.length;e>d;d++)if(c=f.mediaElement[0].canPlayType(g[d].type),"maybe"==c||"probably"==c){f.mediaElement.attr("src",g[d].src),f.mediaElement.attr("type",g[d].type);break}}else f.mediaElement.attr("src",g[0].src),f.mediaElement.attr("type",g[0].type);a(function(){(f.autoPlay&&!VG_UTILS.isMobileDevice()||f.currentState===b.PLAY)&&f.play()}),""==c&&f.onVideoError()},f.mediaElement=d.find(e.vgType),f.sources=c.vgSrc,f.addListeners(),f.onVideoReady(),c.$watch("vgSrc",c.onChangeSource),f.isConfig&&c.$watch(function(){return f.config},function(){f.config&&(c.vgSrc=f.config.sources)})}}}]),angular.module("com.2fdevs.videogular").directive("vgNativeControls",[function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){var e;a.setControls=function(a){a?d.mediaElement.attr("controls",a):d.mediaElement.removeAttr("controls")},d.isConfig?a.$watch(function(){return d.config},function(){d.config&&a.setControls(d.config.controls)}):a.$watch(c.vgNativeControls,function(b,c){e&&b==c||!b?a.setControls():(e=b,a.setControls(e))})}}}}]),angular.module("com.2fdevs.videogular").directive("vgPreload",[function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){var e;a.setPreload=function(a){a?d.mediaElement.attr("preload",a):d.mediaElement.removeAttr("preload")},d.isConfig?a.$watch(function(){return d.config},function(){d.config&&a.setPreload(d.config.preload)}):a.$watch(c.vgPreload,function(b,c){e&&b==c||!b?a.setPreload():(e=b,a.setPreload(e))})}}}}]),angular.module("com.2fdevs.videogular").directive("vgTracks",[function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){var e,f,g,h;a.changeSource=function(){var a=d.mediaElement.children();for(g=0,h=a.length;h>g;g++)a[g].remove();if(e)for(g=0,h=e.length;h>g;g++){f="",f+="<track ";for(var b in e[g])f+=b+'="'+e[g][b]+'" ';f+="></track>",d.mediaElement.append(f)}},a.setTracks=function(b){e=b,d.tracks=b,a.changeSource()},d.isConfig?a.$watch(function(){return d.config},function(){d.config&&a.setTracks(d.config.tracks)}):a.$watch(c.vgTracks,function(b,c){e&&b==c||a.setTracks(b)})}}}}]),angular.module("com.2fdevs.videogular").directive("videogular",[function(){return{restrict:"E",scope:{vgTheme:"=?",vgAutoPlay:"=?",vgPlaysInline:"=?",vgConfig:"@",vgComplete:"&",vgUpdateVolume:"&",vgUpdateTime:"&",vgUpdateState:"&",vgPlayerReady:"&",vgChangeSource:"&",vgError:"&"},controller:"vgController",link:{pre:function(a,b,c,d){d.videogularElement=angular.element(b)}}}}]),angular.module("com.2fdevs.videogular").service("vgConfigLoader",["$http","$q","$sce",function(a,b,c){this.loadConfig=function(d){var e=b.defer();return a({method:"GET",url:d}).then(function(a){for(var b=a.data,d=0,f=b.sources.length;f>d;d++)b.sources[d].src=c.trustAsResourceUrl(b.sources[d].src);e.resolve(b)},function(){e.reject()}),e.promise}}]),angular.module("com.2fdevs.videogular").service("vgFullscreen",["VG_UTILS",function(a){function b(){return null!=document[c.element]}var c=null,d={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",onchange:"fullscreenchange",onerror:"fullscreenerror"},newWebkit:{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},oldWebkit:{enabled:"webkitIsFullScreen",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen",exit:"webkitCancelFullScreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},moz:{enabled:"mozFullScreen",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",onchange:"mozfullscreenchange",onerror:"mozfullscreenerror"},ios:{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitEnterFullscreen",exit:"webkitExitFullscreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",onchange:"msfullscreenchange",onerror:"msfullscreenerror"}};for(var e in d)if(d[e].enabled in document){c=d[e];break}a.isiOSDevice()&&(c=d.ios),this.onchange=c.onchange,this.onerror=c.onerror,this.isAvailable=null!=c,this.isFullScreen=b,this.exit=function(){document[c.exit]()},this.request=function(a){a[c.request]()}}]),angular.module("com.2fdevs.videogular").service("VG_UTILS",function(){this.fixEventOffset=function(a){if(navigator.userAgent.match(/Firefox/i)){var b=a.currentTarget.currentStyle||window.getComputedStyle(a.target,null),c=parseInt(b.borderLeftWidth,10),d=parseInt(b.borderTopWidth,10),e=a.currentTarget.getBoundingClientRect(),f=a.clientX-c-e.left,g=a.clientY-d-e.top;a.offsetX=f,a.offsetY=g}return a},this.getZIndex=function(){for(var a=1,b=document.getElementsByTagName("*"),c=0,d=b.length;d>c;c++)b[c].style.zIndex&&parseInt(b[c].style.zIndex)>a&&(a=parseInt(b[c].style.zIndex)+1);return a},this.isMobileDevice=function(){return"undefined"!=typeof window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")},this.isiOSDevice=function(){return navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)}});